(this.webpackJsonpzlwj_sass_r=this.webpackJsonpzlwj_sass_r||[]).push([[9],{1231:function(e,t,a){"use strict";function n(e){if(null==e)throw new TypeError("Cannot destructure undefined")}a.d(t,"a",(function(){return n}))},1252:function(e,t,a){"use strict";a.r(t);var n=a(56),i=a(59),c=a(60),l=a(67),s=a(66),r=a(0),u=a.n(r),d=a(50),o=a(63),p=a(156),m=a(134),h=a(222),b=a(221),f=a(135),k=a(1204),g=a(86),y=a(1220),E=a(1200),v=a(1202),S=a(454),O=a(129),C={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"}}]},name:"edit",theme:"outlined"},P=a(93),j=function(e,t){return r.createElement(P.a,Object.assign({},e,{ref:t,icon:C}))};j.displayName="EditOutlined";var D=r.forwardRef(j),V=a(1225),N=a(1221),M=function(e){var t=e.children,a=e.onConfirm,n=e.onCancel;return u.a.createElement(N.a,{title:"\u662f\u5426\u5220\u9664\uff1f",onConfirm:a,onCancel:n||function(){}},t)},T=a(1222),I=a(41),x=a.n(I),w=a(1205),z=function(e){Object(l.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,c=new Array(n),l=0;l<n;l++)c[l]=arguments[l];return(e=t.call.apply(t,[this].concat(c))).state={addVisible:!1,menus:"",addDetial:"",editVisible:!1,editDetial:""},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.initial()}},{key:"handleData",value:function(e){return function e(t){x.a.each(t,(function(t,a){t.title=t.menuName,t.key=t.id,t.children=t.childMenu,t.childMenu&&t.childMenu.length&&e(t.childMenu)}))}(e),e}},{key:"initial",value:function(){var e=this;this.props.actions.getSelectChildTree({params:{systemId:this.props.match.params.id},next:function(t){e.setState({menus:t})},refresh:!0})}},{key:"addSubmit",value:function(e){var t=this;this.props.actions.addSelectChildTree(Object(n.a)(Object(n.a)({},e),{},{parentId:this.state.addDetial?this.state.addDetial.id:"",systemId:this.props.match.params.id}),(function(){t.props.utils.OpenNotification("success"),t.setState({addVisible:!1}),t.initial()}))}},{key:"editSubmit",value:function(e){var t=this;this.props.actions.editSelectChildTree(Object(n.a)(Object(n.a)({},e),{},{id:this.state.editDetial.id}),(function(){t.props.utils.OpenNotification("success"),t.setState({editVisible:!1}),t.initial()}))}},{key:"deleteSubmit",value:function(e){var t=this;this.props.actions.deleteSelectChildTree({id:e.id},(function(){t.props.utils.OpenNotification("success"),t.initial()}))}},{key:"render",value:function(){var e=this,t=this.props,a=t.spinning,n=(t.utils,this.state),i=n.addVisible,c=n.menus,l=(n.addDetial,n.editVisible),s=n.editDetial;return u.a.createElement(u.a.Fragment,null,u.a.createElement(k.a,{size:"small",title:"\u6743\u9650\u83dc\u5355",extra:u.a.createElement(g.a,{type:"primary",onClick:function(){return e.setState({addVisible:!0})}},"\u65b0\u589e")},c?u.a.createElement(E.a,{defaultExpandAll:!0,blockNode:!0,treeData:this.handleData(c),titleRender:function(t){return u.a.createElement("div",{className:"flexbetween"},u.a.createElement("span",null,t.title,"(",t.menuKey,")"),u.a.createElement(T.b,{size:20},u.a.createElement(w.a,{onClick:function(){return e.setState({addVisible:!0,addDetial:t})}}),u.a.createElement(D,{onClick:function(){return e.setState({editVisible:!0,editDetial:t})}}),u.a.createElement(N.a,{title:"\u662f\u5426\u5220\u9664\uff1f",onConfirm:e.deleteSubmit.bind(e,t)},u.a.createElement(V.a,null))))}}):u.a.createElement(v.a,{active:!0})),u.a.createElement(O.a,{title:"\u65b0\u589e\u83dc\u5355",spinning:a,visible:i,onCancel:function(){return e.setState({addVisible:!1,addDetial:""})},onOk:this.addSubmit.bind(this),data:[{label:"\u6743\u9650\u540d\u79f0",name:"menuName",type:h.a,rules:!0},{label:"\u6743\u9650key",name:"menuKey",type:h.a,rules:!0},{label:"\u6743\u9650URL",name:"menuUrl",type:h.a},{label:"\u5907\u6ce8",name:"remark",type:h.a}]}),u.a.createElement(O.a,{title:"\u7f16\u8f91\u83dc\u5355",spinning:a,visible:l,onCancel:function(){return e.setState({editVisible:!1,editDetial:""})},onOk:this.editSubmit.bind(this),initialValues:s,data:[{label:"\u6743\u9650\u540d\u79f0",name:"menuName",type:h.a,rules:!0},{label:"\u6743\u9650key",name:"menuKey",type:h.a,rules:!0},{label:"\u83dc\u5355\u7ea7\u522b",name:"menuLevel",type:m.a,selectList:[{name:"\u9879\u76ee\u7ea7\u522b",id:0},{name:"\u516c\u53f8\u7ea7\u522b",id:1},{name:"\u7cfb\u7edf\u7ea7\u522b",id:2}]},{label:"\u6743\u9650URL",name:"menuUrl",type:h.a},{label:"\u5907\u6ce8",name:"remark",type:h.a}]}))}}]),a}(u.a.Component),L=Object(d.b)((function(e){return{utils:e.app.utils,spinning:e.user.spinning}}),(function(e){return{actions:Object(o.b)({getSelectChildTree:S.k,addSelectChildTree:S.b,editSelectChildTree:S.g,deleteSelectChildTree:S.e},e)}}))(z),J=a(1231),A=a(196),B=a(1250),R=Object(A.h)(Object(d.b)((function(e){return{databytype:e.system.databytype,utils:e.app.utils}}),(function(e){return{actions:Object(o.b)({getTreeDateByType:S.n,addBatchMenus:S.a},e)}}))((function(e){var t=e.actions,a=e.databytype,n=e.utils,i=Object(A.g)();Object(J.a)(i),Object(r.useEffect)((function(){t.getTreeDateByType({type:"systema"})}),[]);var c=function e(t){return x.a.each(t,(function(t){t.key=t.id,t.children=t.children||null,t.children&&t.children.length&&e(t.children)})),t};return console.log(n.tData(a?JSON.parse(a):null,"name","id","children")),u.a.createElement(k.a,{size:"small",title:"\u7cfb\u7edf\u83dc\u5355",extra:u.a.createElement(g.a,{type:"primary",onClick:function(){var e=JSON.parse(a);console.log(c(e)),t.addBatchMenus({menusJson:JSON.stringify(c(e)),systemId:26},(function(){n.OpenNotification("success")}))}},"\u521d\u59cb\u5316")},a?u.a.createElement(E.a,{defaultExpandAll:!0,treeData:n.tData(a?JSON.parse(a):null,"name","id","children"),titleRender:function(e){return u.a.createElement(T.b,null,u.a.createElement("span",null,e.name),u.a.createElement(B.a.Text,{type:"danger"},"(",e.id,")"))}}):null)}))),K=m.a.Option,U=h.a.TextArea,_=function(e){Object(l.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,c=new Array(n),l=0;l<n;l++)c[l]=arguments[l];return(e=t.call.apply(t,[this].concat(c))).state={packages:[],addPackageVisible:!1,editPackageVisible:!1,packageDetail:{},currentPackage:{},currentChecked:[]},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.props.actions.getSystemPackage({systemId:this.props.match.params.id},(function(t){e.setState({packages:t})}))}},{key:"addPackageVisible",value:function(e){var t=this;this.props.actions.addSystemPackage(Object(n.a)(Object(n.a)({},e),{},{systemId:this.props.match.params.id}),(function(){t.props.utils.OpenNotification("success"),t.setState({addPackageVisible:!1}),t.props.actions.getSystemPackage({systemId:t.props.match.params.id},(function(e){t.setState({packages:e})}))}))}},{key:"editPackageVisible",value:function(e){var t=this;this.props.actions.editSystemPackage(Object(n.a)(Object(n.a)({},e),{},{id:this.state.packageDetail.id}),(function(){t.props.utils.OpenNotification("success"),t.setState({editPackageVisible:!1}),t.props.actions.getSystemPackage({systemId:t.props.match.params.id},(function(e){t.setState({packages:e})}))}))}},{key:"deleteSubmit",value:function(e,t){var a=this;t.stopPropagation(),this.props.actions.deleteSystemPackage({id:e.id},(function(){a.props.utils.OpenNotification("success"),a.props.actions.getSystemPackage({systemId:a.props.match.params.id},(function(e){a.setState({packages:e})}))}))}},{key:"handleData",value:function(e){return function e(t){x.a.each(t,(function(t,a){t.title=t.menuName,t.key=t.id,t.children=t.childMenu,t.childMenu&&t.childMenu.length&&e(t.childMenu)}))}(e),e}},{key:"render",value:function(){var e=this,t=this.props,a=t.spinning,n=t.menutree,i=t.match,c=this.state,l=c.packages,s=c.addPackageVisible,r=c.editPackageVisible,d=c.packageDetail,o=c.currentPackage,S=c.currentChecked;return u.a.createElement(p.a,{spinning:a},u.a.createElement(b.a,{gutter:10,key:"a"},u.a.createElement(f.a,{span:6},u.a.createElement(R,null)),u.a.createElement(f.a,{span:6},u.a.createElement(L,this.props)),u.a.createElement(f.a,{span:6},u.a.createElement(k.a,{size:"small",title:"\u65b0\u589e\u6743\u9650\u5305",extra:u.a.createElement(g.a,{type:"primary",onClick:function(){return e.setState({addPackageVisible:!0})}},"\u65b0\u589e\u6743\u9650\u5305")},u.a.createElement(y.b,{dataSource:l,bordered:!0,renderItem:function(t){return u.a.createElement(y.b.Item,{style:{cursor:"pointer",padding:8},onClick:function(){e.setState({currentPackage:t}),e.props.actions.findPackageMenu({packageId:t.id},(function(t){e.setState({currentChecked:t})}))},actions:[u.a.createElement(D,{onClick:function(a){a.stopPropagation(),e.setState({editPackageVisible:!0,packageDetail:t})}}),u.a.createElement(M,{onConfirm:e.deleteSubmit.bind(e,t),onCancel:function(e){return e.stopPropagation()}},u.a.createElement(V.a,{onClick:function(e){return e.stopPropagation()}}))]},t.packageName)}}))),u.a.createElement(f.a,{span:6},u.a.createElement(k.a,{size:"small",title:o.packageName,extra:u.a.createElement(g.a,{disabled:!o.packageName,type:"primary",onClick:function(){e.props.actions.savePackageMenu({packageId:o.id,menus:S.join(),systemId:i.params.id})}},"\u4fdd\u5b58")},n?u.a.createElement(E.a,{defaultExpandAll:!0,checkStrictly:!0,checkedKeys:S,checkable:!0,blockNode:!0,treeData:this.handleData(n),onCheck:function(t){var a=t.checked;e.setState({currentChecked:a})}}):u.a.createElement(v.a,{active:!0})))),u.a.createElement(O.a,{title:"\u65b0\u589e\u6743\u9650\u5305",spinning:a,visible:s,onCancel:function(){return e.setState({addPackageVisible:!1})},onOk:this.addPackageVisible.bind(this),data:[{label:"\u6743\u9650\u5305\u540d\u79f0",name:"packageName",type:h.a},{label:"\u9ed8\u8ba4",name:"isDefault",type:u.a.createElement(m.a,null,u.a.createElement(K,{value:"Y"},"\u662f"),u.a.createElement(K,{value:"N"},"\u5426"))},{label:"\u5907\u6ce8",name:"remark",type:U}]}),u.a.createElement(O.a,{title:"\u7f16\u8f91\u6743\u9650\u5305",spinning:a,visible:r,onCancel:function(){return e.setState({editPackageVisible:!1})},onOk:this.editPackageVisible.bind(this),initialValues:d,data:[{label:"\u6743\u9650\u5305\u540d\u79f0",name:"packageName",type:h.a},{label:"\u9ed8\u8ba4",name:"isDefault",type:u.a.createElement(m.a,null,u.a.createElement(K,{value:"Y"},"\u662f"),u.a.createElement(K,{value:"N"},"\u5426"))},{label:"\u5907\u6ce8",name:"remark",type:U}]}))}}]),a}(u.a.Component);t.default=Object(d.b)((function(e){return{menutree:e.system.menutree,utils:e.app.utils,spinning:e.system.spinning}}),(function(e){return{actions:Object(o.b)({getSystemPackage:S.l,addSystemPackage:S.d,editSystemPackage:S.i,deleteSystemPackage:S.f,findPackageMenu:S.j,savePackageMenu:S.o},e)}}))(_)}}]);
//# sourceMappingURL=9.0ae406d8.chunk.js.map